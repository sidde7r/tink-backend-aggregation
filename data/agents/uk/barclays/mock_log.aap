REQUEST 1
GET https://oauth.tiaa.barclays.com/BarclaysPersonal/.well-known/openid-configuration
User-Agent : Tink (+https://www.tink.se/; noc@tink.se)

RESPONSE 1
200
Content-Type: application/json

{"version":"3.0","issuer":"https://oauth.tiaa.barclays.com","authorization_endpoint":"https://oauth.tiaa.barclays.com/BarclaysPersonal/as/authorization.oauth2","token_endpoint":"https://token.tiaa.barclays.com/as/token.oauth2","jwks_uri":"https://keystore.openbanking.org.uk/MOCK_ORG_ID/2SPmPNUU6KrtcgutPlkfBd.jwks","scopes_supported":["accounts","payments","fundsconfirmations","openid"],"claims_supported":["openbanking_intent_id","http://openbanking.org.uk/refresh_token_expires_at","sub"],"response_types_supported":["code","codeid_token"],"response_modes_supported":["fragment","query","form_post"],"grant_types_supported":["implicit","authorization_code","refresh_token","client_credentials"],"subject_types_supported":["public"],"id_token_signing_alg_values_supported":["RS256","PS256"],"token_endpoint_auth_signing_alg_values_supported":["RS256","PS256"],"token_endpoint_auth_methods_supported":["client_secret_basic","client_secret_post","private_key_jwt"],"claim_types_supported":["normal"],"claims_parameter_supported":true,"request_parameter_supported":true,"request_object_signing_alg_values_supported":["RS256","PS256"],"request_object_encryption_alg_values_supported":[],"request_object_encryption_enc_values_supported":[],"request_uri_parameter_supported":false}

REQUEST 2
POST https://token.tiaa.barclays.com/as/token.oauth2
Content-Type: application/x-www-form-urlencoded
Accept: application/json

grant_type=client_credentials
    &scope=accounts
    &redirect_uri=https%3A%2F%2Fapi.tink.se%2Fapi%2Fv1%2Fcredentials%2Fthird-party%2Fcallback&client_id=DUMMY_ID
    &client_secret=DUMMY_SECRET

RESPONSE 2 SET STATE_REFRESH
200
Content-Type: application/json;charset=utf-8

{"access_token":"DUMMY_TPP_ACCESS_TOKEN","token_type":"bearer","expires_in":1798}

REQUEST 3
POST https://telesto.api.barclays:443/open-banking/v3.1/aisp/account-access-consents
Accept: application/json
Authorization: Bearer DUMMY_TPP_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 3
201
Content-Type: application/json;charset=UTF-8
X-Application-Context: zuul-gateway:prod:86ab0063a3d10a7a318be253b6e32cbc
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000
Set-Cookie: 09cc08b965e567968f2b5dc4f6ea9dcf=040df567185881b6f1e10fa88782ca0b;path=/;HttpOnly;Secure

{"Data":{"Permissions":["ReadAccountsDetail","ReadBalances","ReadBeneficiariesDetail","ReadDirectDebits","ReadStandingOrdersDetail","ReadTransactionsCredits","ReadTransactionsDebits","ReadTransactionsDetail","ReadParty"],"ConsentId":"BARCLAYS-A-10000002326251","Status":"AwaitingAuthorisation","CreationDateTime":"2020-01-30T12:43:26.000Z","StatusUpdateDateTime":"2020-01-30T12:43:26.000Z"},"Risk":{},"Links":{"Self":"https://telesto.api.barclays/open-banking/v3.1/aisp/account-access-consents"},"Meta":{}}

REQUEST 4 MATCH STATE_REFRESH
POST https://token.tiaa.barclays.com/as/token.oauth2
Content-Type: application/x-www-form-urlencoded
Accept: application/json

grant_type=authorization_code&redirect_uri=https%3A%2F%2Fapi.tink.se%2Fapi%2Fv1%2Fcredentials%2Fthird-party%2Fcallback&client_id=DUMMY_ID&client_secret=DUMMY_SECRET&code=DUMMY_AUTH_CODE

RESPONSE 4
200
Content-Type: application/json;charset=utf-8

{"access_token":"DUMMY_ACCESS_TOKEN","refresh_token":"DUMMY_REFRESH_TOKEN","scope":"openid accounts","id_token":"DUMMY_ID_TOKEN","token_type":"bearer","expires_in":3600}

REQUEST 5
GET /MOCK_ORG_ID/2SPmPNUU6KrtcgutPlkfBd.jwks
Connection: keep-alive

RESPONSE 5
200
Content-Type: application/json;charset=utf-8

{"keys": []}

REQUEST 6
GET https://telesto.api.barclays:443/open-banking/v3.1/aisp/accounts
Accept: application/json
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 6
200
Content-Type: application/json;charset=UTF-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"Account":[{"Account":[{"Identification":"00000000000000","SchemeName":"UK.OBIE.SortCodeAccountNumber"}],"AccountId":"DUMMY_ACCOUNT_ID","Currency":"GBP","AccountType":"Personal","AccountSubType":"CurrentAccount"}]},"Links":{"Self":"https://telesto.api.barclays/open-banking/v3.1/aisp/accounts"},"Meta":{}}

REQUEST 7
GET https://telesto.api.barclays:443/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/parties
Accept: application/json
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 7
200
Content-Type: application/json;charset=UTF-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"Party":[{"PartyId":"00000000000000000000","FullLegalName":"LITTLE BIG DIGITAL LTD"}]},"Links":{"Self":"https://telesto.api.barclays/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/parties"},"Meta":{}}

REQUEST 8
GET https://telesto.api.barclays:443/open-banking/v3.1/aisp/accounts
Accept: application/json
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 8
200
Content-Type: application/json;charset=UTF-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"Account":[{"Account":[{"Identification":"00000000000000","SchemeName":"UK.OBIE.SortCodeAccountNumber"}],"AccountId":"DUMMY_ACCOUNT_ID","Currency":"GBP","AccountType":"Personal","AccountSubType":"CurrentAccount"}]},"Links":{"Self":"https://telesto.api.barclays/open-banking/v3.1/aisp/accounts"},"Meta":{}}

REQUEST 9
GET https://telesto.api.barclays:443/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/balances
Accept: application/json
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 9
200
Content-Type: application/json;charset=UTF-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"Balance":[{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"30.00","Currency":"GBP"},"CreditDebitIndicator":"Credit","DateTime":"2020-01-30T12:44:09Z","Type":"Expected"}]},"Links":{"Self":"https://telesto.api.barclays/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/balances"},"Meta":{}}

REQUEST 10
GET https://telesto.api.barclays:443/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/transactions?fromBookingDateTime=1990-05-10T00:00:00Z
Accept: application/json
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 10
200
Content-Type: application/json;charset=UTF-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"Transaction":[{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"20.00","Currency":"GBP"},"Balance":{"Amount":{"Amount":"30.00","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2020-01-21T06:53:08Z","CreditDebitIndicator":"Credit","Status":"Booked","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2020-01-21T00:00:00.000Z"},{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"10.00","Currency":"GBP"},"Balance":{"Amount":{"Amount":"10.00","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2020-01-17T17:29:48Z","CreditDebitIndicator":"Credit","Status":"Booked","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2020-01-17T00:00:00.000Z"},{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"319.31","Currency":"GBP"},"Balance":{"Amount":{"Amount":"0.00","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2020-01-17T17:21:51Z","CreditDebitIndicator":"Debit","MerchantDetails":{"MerchantName":"Barclayscurrentaccount"},"Status":"Booked","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2020-01-17T00:00:00.000Z"},{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"6.50","Currency":"GBP"},"Balance":{"Amount":{"Amount":"319.31","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2020-01-09T00:33:59Z","CreditDebitIndicator":"Debit","Status":"Booked","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2020-01-09T00:00:00.000Z"},{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"282.29","Currency":"GBP"},"Balance":{"Amount":{"Amount":"325.81","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2020-01-05T11:03:10Z","CreditDebitIndicator":"Debit","MerchantDetails":{"MerchantName":"AmericanExpress"},"Status":"Booked","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2020-01-06T00:00:00.000Z"}]},"Links":{"First":"https://telesto.api.barclays/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/transactions?toBookingDateTime=2020-01-30T00:00:00.000Z&offset=0&fromBookingDateTime=2018-02-28T00:00:00.000Z&limit=50&includePendingRecords=true","Next":"https://telesto.api.barclays/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/transactions?toBookingDateTime=2020-01-30T00:00:00.000Z&offset=50&fromBookingDateTime=2018-02-28T00:00:00.000Z&limit=50&includePendingRecords=false","Self":"https://telesto.api.barclays/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/transactions?toBookingDateTime=2020-01-30T00:00:00.000Z&fromBookingDateTime=2018-02-28T00:00:00.000Z"},"Meta":{}}

REQUEST 11
GET https://telesto.api.barclays/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/transactions?toBookingDateTime=2020-01-30T00:00:00.000Z&offset=50&fromBookingDateTime=2018-02-28T00:00:00.000Z&limit=50&includePendingRecords=false
Accept: application/json
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 11
200
Content-Type: application/json;charset=UTF-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"Transaction":[{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"16.34","Currency":"GBP"},"Balance":{"Amount":{"Amount":"1446.84","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2019-05-31T14:39:13+01:00","CreditDebitIndicator":"Debit","MerchantDetails":{"MerchantName":"CLOUDFLARE"},"Status":"Booked","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2019-05-31T01:00:00.000+01:00"},{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"12.00","Currency":"GBP"},"Balance":{"Amount":{"Amount":"1463.18","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2019-05-28T12:06:00+01:00","CreditDebitIndicator":"Debit","MerchantDetails":{"MerchantName":"Xero"},"Status":"Booked","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2019-05-28T01:00:00.000+01:00"},{"AccountId":"DUMMY_ACCOUNT_ID","Amount":{"Amount":"4.50","Currency":"GBP"},"Balance":{"Amount":{"Amount":"1475.18","Currency":"GBP"},"CreditDebitIndicator":"Credit","Type":"Information"},"BookingDateTime":"2019-05-27T15:04:47+01:00","CreditDebitIndicator":"Debit","MerchantDetails":{"MerchantName":"Microsoft"},"Status":"Rejected","TransactionInformation":"DUMMY_VALUE","ValueDateTime":"2019-05-28T01:00:00.000+01:00"}]},"Links":{},"Meta":{}}
