# For now we ignore x-jws-signature headers (adding them back is part of task AAP-157)
# x-jws-signature headers are removed from all requests and responses for now
# I made up Response 6 on my own, we need to double check if it reflects reality

REQUEST 1
GET https://oauth.tiaa.barclays.com/BarclaysPersonal/.well-known/openid-configuration
X-Aggregator: Tink Testing

RESPONSE 1
200
Content-Type: application/json
Content-Length: 1302
Connection: keep-alive
Server: Apache
Last-Modified: Tue, 21 May 2019 20:57:42 GMT
Accept-Ranges: bytes
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff

{"version":"3.0","issuer":"https:\/\/oauth.tiaa.barclays.com","authorization_endpoint":"https:\/\/oauth.tiaa.barclays.com\/BarclaysPersonal\/as\/authorization.oauth2","token_endpoint":"https:\/\/token.tiaa.barclays.com\/as\/token.oauth2","jwks_uri":"https://keystore.openbanking.org.uk/0015800000jfAW1AAM/2SPmPNUU6KrtcgutPlkfBd.jwks","scopes_supported":["accounts","payments","fundsconfirmations","openid"],"claims_supported":["openbanking_intent_id","http://openbanking.org.uk/refresh_token_expires_at","sub"],"response_types_supported":["code","code id_token"],"response_modes_supported":["fragment","query","form_post"],"grant_types_supported":["implicit","authorization_code","refresh_token","client_credentials"],"subject_types_supported":["public"],"id_token_signing_alg_values_supported":["RS256","PS256"],"token_endpoint_auth_signing_alg_values_supported":["RS256","PS256"],"token_endpoint_auth_methods_supported":["client_secret_basic","client_secret_post","private_key_jwt"],"claim_types_supported":["normal"],"claims_parameter_supported":true,"request_parameter_supported":true,"request_object_signing_alg_values_supported":["RS256","PS256"],"request_object_encryption_alg_values_supported":[],"request_object_encryption_enc_values_supported":[],"request_uri_parameter_supported":false}

REQUEST 2
POST https://token.tiaa.barclays.com/as/token.oauth2
Content-Type: application/x-www-form-urlencoded
Accept: application/json
X-Aggregator: Tink Testing

grant_type=client_credentials&scope=payments&redirect_uri=https%3A%2F%2Fapi.tink.se%2Fapi%2Fv1%2Fcredentials%2Fthird-party%2Fcallback&client_id=DUMMY_ID&client_secret=DUMMY_SECRET

RESPONSE 2 SET STATE_PAYMENT
200
Content-Type: application/json;charset=utf-8
Transfer-Encoding: chunked
Connection: keep-alive
Referrer-Policy: origin
Cache-Control: no-cache, no-store
Pragma: no-cache
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff

{"access_token":"DUMMY_TPP_ACCESS_TOKEN","token_type":"bearer","expires_in":1799}

REQUEST 3
POST https://telesto.api.barclays:443/open-banking/v3.1/pisp/domestic-payment-consents
Accept: application/json
Content-Type: application/json
X-Aggregator: Tink Testing
x-idempotency-key: 0000000000000000
Authorization: Bearer DUMMY_TPP_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000
x-jws-signature: RkFLRV9TSUdOQVRVUkUK

{"Risk":{},"Data":{"Initiation":{"InstructionIdentification":"b900555d03124056b54930e1c53c9cac","EndToEndIdentification":"b900555d03124056b54930e1c53c9ca","InstructedAmount":{"Amount":"1.00","Currency":"GBP"},"CreditorAccount":{"SchemeName":"UK.OBIE.SortCodeAccountNumber","Identification":"04000469430924","Name":"Ritesh Tink"},"RemittanceInformation":{"Unstructured":"UK Demo"}}}}

RESPONSE 3
201
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Server: Apache
X-Content-Type-Options: nosniff
X-Download-Options: noopen,noopen
Referrer-Header: no-referrer,no-referrer
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, must-revalidate,no-cache;no-store
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"ConsentId":"BARCLAYS-P-10000000245531","CreationDateTime":"2020-03-04T14:34:37Z","Status":"AwaitingAuthorisation","StatusUpdateDateTime":"2020-03-04T14:34:37Z","Initiation":{"InstructionIdentification":"b900555d03124056b54930e1c53c9cac","EndToEndIdentification":"b900555d03124056b54930e1c53c9ca","InstructedAmount":{"Amount":"1.00","Currency":"GBP"},"CreditorAccount":{"SchemeName":"UK.OBIE.SortCodeAccountNumber","Identification":"04000469430924","Name":"Ritesh Tink"},"RemittanceInformation":{"Unstructured":"UK Demo"}}},"Risk":{},"Links":{"Self":"https://telesto.api.barclays/open-banking/v3.1/pisp/domestic-payment-consents"},"Meta":{}}

REQUEST 4 MATCH STATE_PAYMENT
POST https://token.tiaa.barclays.com/as/token.oauth2
Content-Type: application/x-www-form-urlencoded
Accept: application/json
X-Aggregator: Tink Testing

grant_type=authorization_code&redirect_uri=https%3A%2F%2Fapi.tink.se%2Fapi%2Fv1%2Fcredentials%2Fthird-party%2Fcallback&client_id=DUMMY_ID&client_secret=DUMMY_SECRET&code=DUMMY_AUTH_CODE

RESPONSE 4
200
Content-Type: application/json;charset=utf-8
Transfer-Encoding: chunked
Connection: keep-alive
Referrer-Policy: origin
Cache-Control: no-cache, no-store
Pragma: no-cache
X-XSS-Protection: 1; mode=block
X-Content-Type-Options: nosniff

{"access_token":"DUMMY_ACCESS_TOKEN","token_type":"Bearer","expires_in":1799}

REQUEST 5
GET /0015800000jfAW1AAM/2SPmPNUU6KrtcgutPlkfBd.jwks
Connection: keep-alive
X-Aggregator: Tink Testing

RESPONSE 5
200
Content-Type: application/json;charset=utf-8
Transfer-Encoding: chunked
Connection: keep-alive
Date: Thu, 30 Jan 2020 12:43:59 GMT
Cache-Control: no-cache, no-store
Pragma: no-cache
Expires: Thu, 01 Jan 1970 00:00:00 GMT

{"keys": []}

REQUEST 6
POST https://telesto.api.barclays:443/open-banking/v3.1/pisp/domestic-payments
Accept: application/json
Content-Type: application/json
X-Aggregator: Tink Testing
x-idempotency-key: 0000000000000000
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-financial-id: 0015800000jfAW1AAM
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000
x-jws-signature: RkFLRV9TSUdOQVRVUkUK

{"Risk":{},"Data":{"ConsentId":"BARCLAYS-P-10000000245531","Initiation":{"RemittanceInformation":{"Unstructured":"UK Demo"},"EndToEndIdentification":"b900555d03124056b54930e1c53c9ca","InstructionIdentification":"b900555d03124056b54930e1c53c9cac","CreditorAccount":{"SchemeName":"UK.OBIE.SortCodeAccountNumber","Identification":"04000469430924","Name":"Ritesh Tink"},"InstructedAmount":{"Amount":"1.00","Currency":"GBP"}}}}

RESPONSE 6
201
Content-Type: application/json;charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Server: Apache
X-Content-Type-Options: nosniff
X-Download-Options: noopen,noopen
Referrer-Header: no-referrer,no-referrer
X-XSS-Protection: 1; mode=block
Cache-Control: no-cache, no-store, must-revalidate,no-cache;no-store
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"DomesticPaymentId":"BARCLAYS-P-10000000245531","ConsentId":"BARCLAYS-P-10000000245531","CreationDateTime":"2020-03-04T14:35:17Z","Status":"AcceptedSettlementInProcess","StatusUpdateDateTime":"2020-03-04T14:35:13Z","Initiation":{"InstructionIdentification":"b900555d03124056b54930e1c53c9cac","EndToEndIdentification":"b900555d03124056b54930e1c53c9ca","InstructedAmount":{"Amount":"1.00","Currency":"GBP"},"CreditorAccount":{"SchemeName":"UK.OBIE.SortCodeAccountNumber","Identification":"04000469430924","Name":"Ritesh Tink"},"RemittanceInformation":{"Unstructured":"UK Demo"}}},"Links":{"Self":"https://telesto.api.barclays/open-banking/v3.1/pisp/domestic-payments"},"Meta":{}}

REQUEST 7
GET https://telesto.api.barclays:443/open-banking/v3.1/pisp/domestic-payments/BARCLAYS-P-10000000245531
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000
Accept: application/json
x-fapi-financial-id: 0015800000jfAW1AAM
x-idempotency-key : 0000000000000000
X-Aggregator: Tink Testing

RESPONSE 7
200
Content-Type: application/json;charset=UTF-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Risk": {}, "Data": {"DomesticPaymentId": "BARCLAYS-P-10000000245531", "ConsentId": "BARCLAYS-P-10000000245531", "Status": "AcceptedSettlementCompleted", "Initiation": {"DebtorAccount": {"SchemeName":"UK.OBIE.SortCodeAccountNumber","Identification":"2314701111111"}, "RemittanceInformation": {"Unstructured":"UK Demo"}, "CreditorAccount": {"SchemeName":"UK.OBIE.SortCodeAccountNumber","Identification":"04000469430924","Name":"Ritesh Tink"}, "InstructedAmount": {"Amount":"1.00","Currency":"GBP"}}}}
