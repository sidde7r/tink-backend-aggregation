
REQUEST 1
POST https://tpp-auth.seb.se/auth/bid/v2/authentications
Accept: application/json

RESPONSE 1 SET A0
201
Date: Tue, 02 Mar 2021 10:07:41 GMT
Date: Tue, 02 Mar 2021 10:07:41 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "auto_start_token": "a7b3a1cc-e673-4184-b34d-11aa9c0c5276"
}

REQUEST 2 MATCH A0
GET https://tpp-auth.seb.se/auth/bid/v2/authentications
Accept: application/json

RESPONSE 2 SET A1
200
Date: Tue, 02 Mar 2021 10:07:41 GMT
Date: Tue, 02 Mar 2021 10:07:41 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "hint_code": "OUTSTANDING_TRANSACTION",
    "status": "PENDING"
}

REQUEST 3 MATCH A1
GET https://tpp-auth.seb.se/auth/bid/v2/authentications
Accept: application/json
x-seb-csrf: CSRF_TOKEN

RESPONSE 3 SET STATE3
200
Date: Tue, 02 Mar 2021 10:07:46 GMT
Date: Tue, 02 Mar 2021 10:07:46 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "hint_code": "OUTSTANDING_TRANSACTION",
    "status": "PENDING"
}

REQUEST 4 MATCH STATE3
GET https://tpp-auth.seb.se/auth/bid/v2/authentications
Accept: application/json

RESPONSE 4 SET STATE4
200
Date: Tue, 02 Mar 2021 10:07:51 GMT
Date: Tue, 02 Mar 2021 10:07:51 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "hint_code": "USER_SIGN",
    "status": "PENDING"
}

REQUEST 5 MATCH STATE4
GET https://tpp-auth.seb.se/auth/bid/v2/authentications
Accept: application/json

RESPONSE 5 SET STATE5
200
Date: Tue, 02 Mar 2021 10:08:00 GMT
Date: Tue, 02 Mar 2021 10:08:00 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "status": "COMPLETE"
}

REQUEST 6 MATCH STATE5
GET https://tpp-auth.seb.se/mga/sps/oauth/oauth20/dpsd2/authorize?client_id=dummyId&response_type=code&scope=psd2_accounts+psd2_payments&redirect_uri=https://127.0.0.1:7357/api/v1/thirdparty/callback
Accept: application/json

RESPONSE 6 SET STATE6
200
Date: Tue, 02 Mar 2021 10:08:01 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "CONSENT_FORM_VERIFIER": "I1H596ojtYZQA8NcbSA4"
}

REQUEST 7 MATCH STATE6
POST https://tpp-auth.seb.se/mga/sps/oauth/oauth20/dpsd2/authorize
Accept: application/json
Content-Type: application/x-www-form-urlencoded

scope=psd2_accounts+psd2_payments&trust_level=permit&consent_form_verifier=I1H596ojtYZQA8NcbSA4

RESPONSE 7 SET STATE7
200
Date: Tue, 02 Mar 2021 10:08:01 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "code": "eHk31TFKeCI9uc0SOw5ihUAb3Wxav6",
    "state": "null"
}

REQUEST 8 MATCH STATE7
POST https://tpp-api.sebgroup.com/mga/sps/oauth/oauth20/dpsd2/token
Accept: application/json
Content-Type: application/x-www-form-urlencoded

client_id=dummyId&client_secret=dummySecret&redirect_uri=https%3A%2F%2F127.0.0.1%3A7357%2Fapi%2Fv1%2Fthirdparty%2Fcallback&grant_type=authorization_code&code=eHk31TFKeCI9uc0SOw5ihUAb3Wxav6&scope=psd2_accounts+psd2_payments

RESPONSE 8 SET STATE8
200
Date: Tue, 02 Mar 2021 10:08:01 GMT
Content-Type: application/json
x-seb-csrf: CSRF_TOKEN

{
    "access_token": "**MASKEDEh**",
    "expires_in": 599,
    "refresh_token": "**MASKEDtN**",
    "scope": "psd2_accounts psd2_payments",
    "token_type": "**MASKEDJF**"
}

REQUEST 9 MATCH STATE8
POST https://tpp-api.sebgroup.com/tpp/pis/v6/identified2/payments/swedish-domestic-private-bankgiros
Accept: application/json
Content-Type: application/json

{
    "creditorAccount": {
        "bgnr": "5768353"
    }, 
    "creditorAccountMessage": null, 
    "creditorName": "Tink",
    "debtorAccount": {
        "iban": "SE4550000000058398257466"
    }, 
    "debtorAccountMessage": null, 
    "instructedAmount": {
        "amount": "585.57",
        "currency": "SEK"
    }, 
    "remittanceInformationStructured": {
        "reference": "1047514784933",
        "referenceType": "OCR"
    }, 
    "remittanceInformationUnstructured": null, 
    "requestedExecutionDate": "2021-01-21",
    "templateId": "swedish-domestic-private-bankgiros"
}

RESPONSE 9 SET STATE9
201
Date: Thu, 25 Feb 2021 00:32:24 GMT
Date: Thu, 25 Feb 2021 00:32:25 GMT
Content-Type: application/json

{
    "_links": {
        "status": {
            "href": "/payments/swedish-domestic-private-bankgiros/STOHYD01210225013225147906000001/status"
        }
    }, 
    "creditorAccount": {
        "bgnr": "3394012"
    }, 
    "debtorAccount": {
        "iban": "SE6450000000056240346527"
    }, 
    "instructedAmount": {
        "amount": "5493.0", 
        "currency": "SEK"
    }, 
    "paymentId": "STOHYD01210225013225147906000001", 
    "remittanceInformationStructured": {
        "reference": "1252496508", 
        "referenceType": "OCR"
    }, 
    "requestedExecutionDate": "2021-02-25", 
    "templateId": "swedish-domestic-private-bankgiros"
}

REQUEST 2 MATCH STATE9
GET https://tpp-api.sebgroup.com/tpp/pis/v6/identified2/payments/swedish-domestic-private-bankgiros/STOHYD01210225013225147906000001/status
Accept: application/json
Content-Type: application/json

RESPONSE 2 SET STATE10
200
Date: Thu, 25 Feb 2021 00:32:25 GMT
Date: Thu, 25 Feb 2021 00:32:25 GMT
Content-Type: application/json

{
    "_links": {
        "status": {
            "href": "/payments/swedish-domestic-private-bankgiros/STOHYD01210225013225147906000001/status"
        }
    }, 
    "paymentId": "STOHYD01210225013225147906000001", 
    "transactionStatus": "RCVD"
}

REQUEST 3 MATCH STATE10
GET https://tpp-api.sebgroup.com/tpp/pis/v6/identified2/payments/swedish-domestic-private-bankgiros/STOHYD01210225013225147906000001/status
Accept: application/json
Content-Type: application/json

RESPONSE 3
200
Date: Thu, 25 Feb 2021 00:32:25 GMT
Date: Thu, 25 Feb 2021 00:32:25 GMT
Content-Type: application/json

{
    "_links": {
        "status": {
            "href": "/payments/swedish-domestic-private-bankgiros/STOHYD01210225013225147906000001/status"
        }
    }, 
    "paymentId": "STOHYD01210225013225147906000001", 
    "tppMessages": [
        "A similar payment is already in upcoming events."
    ], 
    "transactionStatus": "RJCT"
}
