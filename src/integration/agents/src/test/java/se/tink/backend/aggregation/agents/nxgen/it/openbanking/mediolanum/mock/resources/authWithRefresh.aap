-----------------------------------------------------------------------------------
REQUEST 1
POST https://api.mediolanum.it/psd2/v1.2/bg/03062/v1/consents
Accept: application/json
Content-Type: application/json
X-Request-ID: 00000000-0000-4000-0000-000000000000
PSU-IP-Address: 127.0.0.1
TPP-Redirect-Uri: dummy

{
  "access": {
    "availableAccounts": "allAccounts"
  },
  "recurringIndicator": true,
  "validUntil": "1992-07-08",
  "frequencyPerDay": 4,
  "combinedServiceIndicator": false
}

-----------------------------------------------------------------------------------
RESPONSE 1
401
Date: Thu, 07 Oct 2021 12:36:54 GMT
Date: Thu, 07 Oct 2021 12:36:55 GMT
Max-Forwards: ***
X-CorrelationID: ***
Via:
Content-Type: application/json
Content-Length: 971

{
  "result": {
    "status": 401,
    "status_message": "Unathorized",
    "url": "https://www.apimediolanum.it/ecm/login?abi\u003d03062\u0026lang\u003dIT\u0026cancel_link\u003dhttps://tpp.psd2.cedacrigroup.it/\u0026d\u003deyJhbGciOiJSUzI1NiJ9.ewogICJpc3MiIDogIkNlZGFjcmkiLAogICJ1dWlkIiA6ICJJZC1lN2U5NWU2MWE3MzAxMGU3ODllMzI3ZWYiLAogICJleHAiIDogMTYzMzYxMDUxNSwKICAiYWJpIiA6ICIwMzA2MiIsCiAgImFwaSIgOiAiaHR0cDovL3BzZDItdHBwYXV0aC1hcHAtYXktdHBwYXV0aDAucHJkLm9jcC5jZWRhY3JpZ3JvdXAuaXQvcHNkMi92MS90cHBhdXRoIiwKICAidHBwX25hbWUiIDogIlBTRDIgUXVhbGlmaWVkIFdlYnNpdGUgQXV0aGVudGljYXRpb24iLAogICJ0cHBfaWQiIDogIlBTRFNFLUZJTkEtNDQwNTkiLAogICJ0cHBfdHlwZSIgOiAiQUlTUCIKfQ.H-IUtwBcfqSDTKNn6dU_cM5Bb1hDPG6u8HoiQT5I_dw0kMQboze_hzHvvyPSZUgMd_2vujZmhQqesmxEWIFqpEM1Qoe1sVGKOhoLzuE9OFSHXxUNkol90HPYEhDkyTlFM0QbD1mEMO-kdr23qksn_8hP-_ZQkzf4SgXc9qubpvscYFA2O-neZ7X6FK6ATZ7dVHFjUib4R7OmTrl-9TIX-W-bNJ50z5MqWzav_b3wGJOWjWgbT7aNfGNpQuspubBCr29TYKLg6Ep9V8RYbmhWbOk1081TKx8WsF4GyHRKKX3mylM8zHigEuwZd4TWEVSLVZLMH1wc3I5LVWw25I0w4g"
  }
}

-----------------------------------------------------------------------------------
REQUEST 2
POST https://api.mediolanum.it:9090/oauth/token
Content-Type: application/x-www-form-urlencoded

code=woot&client_id=test_client_id&client_secret=test_client_secret&redirect_uri=test_redirect_url&grant_type=authorization_code

-----------------------------------------------------------------------------------
RESPONSE 2
200
Date: Thu, 07 Oct 2021 12:37:52 GMT
X-CorrelationID: ***
Host: api.mediolanum.it:9090
User-Agent: Tink (+https://www.tink.se/; noc@tink.se)
X-Forwarded-For: 83.5.122.47, 10.199.2.7
X-Forwarded-Host: api.mediolanum.it:9090
Content-Type: application/json
Keep-Alive: ***
Connection: Keep-Alive
Transfer-Encoding: chunked

{
  "access_token": "SuperAwesomeAccessToken",
  "token_type": "Bearer",
  "expires_in": 7776000
}

-----------------------------------------------------------------------------------
REQUEST 3
POST https://api.mediolanum.it/psd2/v1.2/bg/03062/v1/consents
Accept: application/json
Content-Type: application/json
X-Request-ID: 00000000-0000-4000-0000-000000000000
PSU-IP-Address: 127.0.0.1
TPP-Redirect-Uri: test_redirect_url?state=00000000-0000-4000-0000-000000000000
TPP-Nok-Redirect-Uri: test_redirect_url?state=00000000-0000-4000-0000-000000000000&nok=true
Authorization: Bearer SuperAwesomeAccessToken

{
  "access": {
    "availableAccounts": "allAccounts"
  },
  "recurringIndicator": true,
  "validUntil": "1992-07-08",
  "frequencyPerDay": 4,
  "combinedServiceIndicator": false
}



-----------------------------------------------------------------------------------
RESPONSE 3
201
Date: Thu, 07 Oct 2021 12:37:53 GMT
Date: Thu, 07 Oct 2021 12:37:53 GMT
Max-Forwards: ***
X-CorrelationID: ***
ASPSP-SCA-Approach: ***
Location: ***
Via:
X-Request-ID: 00000000-0000-4000-0000-000000000000
Content-Type: application/json

{
  "consentStatus": "received",
  "consentId": "test_consent_id",
  "_links": {
    "scaRedirect": {
      "href": "https://www.apimediolanum.it/ecm/consent?consent-id\u003dtest_consent_id\u0026d\u003deyJhbGciOiJSUzI1NiJ9.ewogICJpc3MiIDogIkNlZGFjcmkiLAogICJ1dWlkIiA6ICJJZC0yMWVhNWU2MThkY2U0OGM4NjhiMmE0NjciLAogICJleHAiIDogMTYzMzYxMDU3NCwKICAiYWJpIiA6ICIwMzA2MiIsCiAgImFjY2Vzc190b2tlbiIgOiAiVHQ1RWZ1VHlJRUw0aXZHWjlIZ1VJVjhDMXhacUJjVTRYUEN4NlBLaHQ5Yzg3ZXpuUnNMTWNHIiwKICAiY29uc2VudF9pZCIgOiAiYzQ0YzJmMjktM2EyNy00ZDRjLTk4ZDItODMyYTdkMWYxMGViIiwKICAidGltZXN0YW1wIiA6ICIxNjMzNjEwMjc0IiwKICAidHBwX25hbWUiIDogIlBTRDIgUXVhbGlmaWVkIFdlYnNpdGUgQXV0aGVudGljYXRpb24iLAogICJ0cHBfaWQiIDogIlBTRFNFLUZJTkEtNDQwNTkiLAogICJ0cHBfdHlwZSIgOiAiQUlTUCIsCiAgIlBzdUlwQWRkcmVzcyIgOiAiMTI3LjAuMC4xIgp9.L5-72eGgSYk1SQsbDYrTVsIHBV7TENsUDA2OxUNRiHHOSIfyiSDv1eGS4j3uC5--zdwQvAbZIBonF5HORdui56Li6NH3CIWpm8QQKJZJHNehY7J-eNroJo8VZsZOADTdL2qip04ehETJubOffMbH4niKhBuJxdifqx7jJxcHW5n1GvHSnrDoC5l5-onuExSs6uDzXPqxV8IZs6vX69oSf1zRw82mEnwQxHpAe9jK5Hm9wMsrHTwD8gGMltTFfO2ovbDnQAzCUAX4OmSYsLkE9pGFt6QDMBNHRZzKhT9eW8SHvUukeTmT8LTg302WZZtyX9a26zejg373xkykcSsVJA"
    }
  }
}



-----------------------------------------------------------------------------------
REQUEST 4
GET https://api.mediolanum.it/psd2/v1.2/bg/03062/v1/consents/test_consent_id
Accept: application/json
Content-Type: application/json
X-Request-ID: 00000000-0000-4000-0000-000000000000
PSU-IP-Address: 127.0.0.1
Authorization: Bearer SuperAwesomeAccessToken


-----------------------------------------------------------------------------------
RESPONSE 4
200
Date: Thu, 07 Oct 2021 12:40:37 GMT
Date: Thu, 07 Oct 2021 12:40:37 GMT
Max-Forwards: ***
X-CorrelationID: ***
Via:
X-Request-ID: 00000000-0000-4000-0000-000000000000
Content-Type: application/json

{
  "access": {
    "availableAccounts": "allAccounts"
  },
  "recurringIndicator": true,
  "validUntil": "2022-01-04",
  "frequencyPerDay": 4,
  "lastActionDate": "2021-10-07",
  "consentStatus": "valid"
}

-----------------------------------------------------------------------------------
REQUEST 5
GET https://api.mediolanum.it/psd2/v1.2/bg/03062/v1/accounts?withBalance=true
Accept: application/json
Content-Type: application/json
X-Request-ID: 00000000-0000-4000-0000-000000000000
PSU-IP-Address: 127.0.0.1
Consent-ID: test_consent_id
Authorization: Bearer SuperAwesomeAccessToken

-----------------------------------------------------------------------------------
RESPONSE 5
200
Date: Thu, 07 Oct 2021 12:40:38 GMT
Date: Thu, 07 Oct 2021 12:40:38 GMT
Max-Forwards: ***
X-CorrelationID: ***
Via:
X-Request-ID: 00000000-0000-4000-0000-000000000000
Content-Type: application/json
Content-Length: 393

{
  "accounts": [
    {
      "balances": [
        {
          "balanceAmount": {
            "amount": "476.00",
            "currency": "EUR"
          },
          "balanceType": "expected",
          "referenceDate": "2021-10-07"
        },
        {
          "balanceAmount": {
            "amount": "476.00",
            "currency": "EUR"
          },
          "balanceType": "interimAvailable",
          "referenceDate": "2021-10-07"
        }
      ],
      "currency": "EUR",
      "iban": "IT5412345678912345678915948",
      "ownerName": "Imie Nazwisko",
      "resourceId": "IT5412345678912345678915948_EUR"
    }
  ]
}



-----------------------------------------------------------------------------------
REQUEST 6
GET https://api.mediolanum.it/psd2/v1.2/bg/03062/v1/accounts/IT5412345678912345678915948_EUR/transactions?bookingStatus=booked&dateFrom=1987-04-10&dateTo=1992-04-10
Accept: application/json
Content-Type: application/json
X-Request-ID: 00000000-0000-4000-0000-000000000000
PSU-IP-Address: 127.0.0.1
Consent-ID: test_consent_id
Authorization: Bearer SuperAwesomeAccessToken

-----------------------------------------------------------------------------------
RESPONSE 6
200
Date: Thu, 07 Oct 2021 12:40:39 GMT
Date: Thu, 07 Oct 2021 12:40:40 GMT
Max-Forwards: ***
X-CorrelationID: ***
Via:
X-Request-ID: 00000000-0000-4000-0000-000000000000
Content-Type: application/json
Content-Length: 1423

{
  "account": {
    "iban": "IT5412345678912345678915948"
  },
  "transactions": {
    "booked": [
      {
        "transactionAmount": {
          "currency": "EUR",
          "amount": "-22.50"
        },
        "bookingDate": "2021-10-01",
        "remittanceInformationUnstructured": "DI TENUTA DEL CONTO",
        "remittanceInformationUnstructuredArray": [
          "DI TENUTA DEL CONTO"
        ]
      },
      {
        "transactionAmount": {
          "currency": "EUR",
          "amount": "-22.50"
        },
        "bookingDate": "2021-07-01",
        "remittanceInformationUnstructured": "DI TENUTA DEL CONTO",
        "remittanceInformationUnstructuredArray": [
          "DI TENUTA DEL CONTO"
        ]
      },
      {
        "transactionAmount": {
          "currency": "EUR",
          "amount": "-5.00"
        },
        "bookingDate": "2021-04-16",
        "remittanceInformationUnstructured": "TINK TEST",
        "remittanceInformationUnstructuredArray": [
          "TINK TEST"
        ]
      }
    ],
    "_links": {
      "account": {
        "href": "/v1/accounts/IT5412345678912345678915948_EUR"
      }
    }
  }
}
