REQUEST 1
GET https://authorise-api.lloydsbank.co.uk/prod01/channel/lyds/personal/.well-known/openid-configuration
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI

RESPONSE 1
200
Content-Type: application/json
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI

{
    "version": 1.1,
    "issuer": "https://authorise-api.lloydsbank.co.uk/prod01/channel/lyds/personal",
    "authorization_endpoint": "https://authorise-api.lloydsbank.co.uk/prod01/lbg/lyds/personal/oidc-api/v1.1/authorize",
    "token_endpoint": "https://secure-api.lloydsbank.com/prod01/lbg/lyds/oidc-api/v1.1/token",
    "registration_endpoint": "https://secure-api.lloydsbank.com/prod01/lbg/dcr-api/v1.0/register",
    "jwks_uri": "https://keystore.openbanking.org.uk/0015800000jf9GgAAI/2QGUgXr5LAFcTUGkNP657c.jwks",
    "scopes_supported": [
        "openid",
        "accounts",
        "payments",
        "fundsconfirmations",
        "name-verification",
        "eventpolling"
    ],
    "claims_supported": [
        "iss",
        "iat",
        "sub",
        "acr",
        "openbanking_intent_id",
        "aud",
        "nonce",
        "exp",
        "brand",
        "channel",
        "at_hash"
    ],
    "response_types_supported": [
        "code id_token",
        "code"
    ],
    "grant_types_supported": [
        "authorization_code",
        "client_credentials"
    ],
    "subject_types_supported": [
        "pairwise"
    ],
    "id_token_signing_alg_values_supported": [
        "PS256"
    ],
    "request_object_signing_alg_values_supported": [
        "RS256",
        "RS384",
        "RS512",
        "PS256"
    ],
    "token_endpoint_auth_methods_supported": [
        "client_secret_basic",
        "client_secret_post"
    ],
    "claims_parameter_supported": true,
    "request_parameter_supported": true,
    "request_uri_parameter_supported": false
}

REQUEST 2
POST https://secure-api.lloydsbank.com/prod01/lbg/lyds/oidc-api/v1.1/token
Content-Type: application/x-www-form-urlencoded
Accept: application/json
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI

grant_type=client_credentials
    &scope=accounts
    &redirect_uri=https%3A%2F%2Fapi.tink.se%2Fapi%2Fv1%2Fcredentials%2Fthird-party%2Fcallback
    &client_id=DUMMY_CLIENT_ID
    &client_secret=DUMMY_SECRET

RESPONSE 2
200
Content-Type: application/json
Connection: keep-alive

{
    "access_token": "DUMMY_TPP_ACCESS_TOKEN",
    "token_type": "bearer",
    "expires_in": 1798,
    "consented_on": 1615555637,
    "scope": "accounts"
}

REQUEST 3
POST https://secure-api.lloydsbank.com/prod01/lbg/lyds/open-banking/v3.1/aisp/account-access-consents
Accept: application/json
Content-Type: application/json
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI
Authorization: Bearer DUMMY_TPP_ACCESS_TOKEN
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{"Data":{"Permissions":["ReadAccountsDetail","ReadBalances","ReadBeneficiariesDetail","ReadTransactionsCredits","ReadTransactionsDetail","ReadTransactionsDebits"]},"Risk":{}}
RESPONSE 3
201
Content-Type: application/json;charset=utf-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{
    "Data": {
        "ConsentId": "LLOYDS-A-10000002326251",
        "Status": "AwaitingAuthorisation",
        "CreationDateTime": "2021-03-12T13:27:18Z",
        "StatusUpdateDateTime": "2021-03-12T13:27:18Z",
        "Permissions": [
            "ReadAccountsDetail",
            "ReadTransactionsCredits",
            "ReadDirectDebits",
            "ReadTransactionsDebits",
            "ReadBeneficiariesDetail",
            "ReadBalances",
            "ReadStandingOrdersDetail",
            "ReadTransactionsDetail"
        ]
    },
    "Risk": {},
    "Links": {
        "Self": "https://secure-api.lloydsbank.com/prod01/lbg/lyds/open-banking/v3.1/aisp/account-access-consents"
    },
    "Meta": {
        "TotalPages": 1
    }
}

REQUEST 4
GET https://keystore.openbanking.org.uk/0015800000jf9GgAAI/2QGUgXr5LAFcTUGkNP657c.jwks
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI

RESPONSE 4
200
Content-Type: application/jwk+json

{"keys":[]}

REQUEST 5
POST https://secure-api.lloydsbank.com/prod01/lbg/lyds/oidc-api/v1.1/token
Content-Type: application/x-www-form-urlencoded
Accept: application/json
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI

grant_type=authorization_code
    &redirect_uri=https%3A%2F%2Fapi.tink.se%2Fapi%2Fv1%2Fcredentials%2Fthird-party%2Fcallback
    &client_id=DUMMY_CLIENT_ID
    &client_secret=DUMMY_SECRET
    &code=DUMMY_AUTH_CODE

RESPONSE 5
200
Content-Type: application/json

{
    "access_token": "DUMMY_ACCESS_TOKEN",
    "refresh_token": "DUMMY_REFRESH_TOKEN",
    "scope": "openid accounts",
    "id_token": "DUMMY_ID_TOKEN",
    "token_type": "bearer",
    "expires_in": 3600
}

REQUEST 6
GET https://secure-api.lloydsbank.com/prod01/lbg/lyds/open-banking/v3.1/aisp/accounts
Accept: application/json
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 6
200
Content-Type: application/json;charset=utf-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{
    "Data": {
        "Account": [
            {
                "AccountId": "DUMMY_ACCOUNT_ID",
                "Currency": "GBP",
                "AccountType": "Business",
                "AccountSubType": "CurrentAccount",
                "OpeningDate": "2020-11-06T00:00:00.000Z",
                "MaturityDate": "2021-11-05",
                "Account": [
                    {
                        "SchemeName": "UK.OBIE.SortCodeAccountNumber",
                        "Identification": "00000000000000",
                        "Name": "Tadeusz Norek"
                    }
                ]
            }
        ]
    },
    "Meta": {
        "TotalPages": 1
    },
    "Links": {
        "Self": "https://secure-api.lloydsbank.com/prod01/lbg/lyds/open-banking/v3.1/aisp/accounts"
    }
}
REQUEST 7
GET https://secure-api.lloydsbank.com/prod01/lbg/lyds/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/balances
Accept: application/json
X-Aggregator: Tink Testing
x-fapi-financial-id: 0015800000jf9GgAAI
Authorization: Bearer DUMMY_ACCESS_TOKEN
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

RESPONSE 7
200
Content-Type: application/json;charset=utf-8
x-fapi-interaction-id: 00000000-0000-4000-0000-000000000000

{
    "Data": {
        "Balance": [
            {
                "AccountId": "DUMMY_ACCOUNT_ID",
                "Amount": {
                    "Amount": "43.22",
                    "Currency": "GBP"
                },
                "CreditDebitIndicator": "Credit",
                "Type": "InterimBooked",
                "DateTime": "2021-03-12T13:27:45Z"
            },
            {
                "AccountId": "DUMMY_ACCOUNT_ID",
                "Amount": {
                    "Amount": "43.22",
                    "Currency": "GBP"
                },
                "CreditDebitIndicator": "Credit",
                "Type": "InterimAvailable",
                "DateTime": "2021-03-12T13:27:45Z"
            }
        ]
    },
    "Links": {
        "Self": "https://secure-api.lloydsbank.com/prod01/lbg/lyds/open-banking/v3.1/aisp/accounts/DUMMY_ACCOUNT_ID/balances"
    },
    "Meta": {
        "TotalPages": 1
    }
}
