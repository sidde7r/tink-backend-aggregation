package se.tink.backend.aggregation.agents.nxgen.be.openbanking.argenta.utils;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.Assert.assertThrows;

import org.junit.Test;

public class CertificateValuesProviderTest {

    String base64EncodedCertificate =
            "LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUgxakNDQmI2Z0F3SUJBZ0lRZlUrL09tNUU5eUJtTGMvT0sybFlyREFOQmdrcWhraUc5dzBCQVFzRkFEQ0IKc2pFTE1Ba0dBMVVFQmhNQ1VGUXhRakJBQmdOVkJBb01PVTFWVEZSSlEwVlNWQ0F0SUZObGNuWnB3NmR2Y3lCawpaU0JEWlhKMGFXWnBZMkhEcDhPamJ5QkZiR1ZqZEhMRHMyNXBZMkVnVXk1QkxqRWdNQjRHQTFVRUN3d1hRMlZ5CmRHbG1hV05oZEdsdmJpQkJkWFJvYjNKcGRIa3hQVEE3QmdOVkJBTU1ORTFWVEZSSlEwVlNWQ0JVY25WemRDQlQKWlhKMmFXTmxjeUJEWlhKMGFXWnBZMkYwYVc5dUlFRjFkR2h2Y21sMGVTQXdNRFV3SGhjTk1qRXdOREV5TVRReApNREU1V2hjTk1qTXdOREV5TWpNMU9UVTVXakNCaFRFTE1Ba0dBMVVFQmhNQ1UwVXhFREFPQmdOVkJBb01CMVJwCmJtc2dRVUl4R1RBWEJnTlZCR0VNRUZCVFJGTkZMVVpKVGtFdE5EUXdOVGt4TnpBMUJnTlZCQXNNTGxCVFJESWcKVVhWaGJHbG1hV1ZrSUVObGNuUnBabWxqWVhSbElHWnZjaUJGYkdWamRISnZibWxqSUZObFlXd3hFREFPQmdOVgpCQU1NQjFScGJtc2dRVUl3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRRFdGYWx2CkxtbFBTVFFvdmR0bGMyalJDU0lPMXZNU1NqNS9ROGQyUlpCYUpIaitMZTR4YjBrL1FPNUJEdG1PTk5oOEJiem0KZnpicWJreC9DaXoxREdhWEJiKzJjTDZhcDFXb3lkMFFaY1JPVWFkQ1N0SFpaWWc4d3A3eXFnZHBsUU01OW0xSQo4eUJrRkMxNWI5dHZ1bGNsZjVqNDRqbnFNMUhieFRjWEZzQnBHaUM1dmIrSUFsbGF5dHl5ZWZDMS9jVC9NOUZkClgvVk13aldTWFZaMnBia1pRSXlDTTkzSlZaWER1ZGgrT0ZmbmVBa3NCUU8rN3NENkdvUEpvZE1kRVdOUkdXNUgKWVIxNUlaV2orS2NVUzhBV2pWQmw1UTFyb3ZRNHgwUUVXcmlKOVVySjRjTVQ3RlJRc1BZVllrNTM3V2s2VFhPYwp3TjZEZDgxbEtxbGZMZkJ2QWdNQkFBR2pnZ01STUlJRERUQU1CZ05WSFJNQkFmOEVBakFBTUI4R0ExVWRJd1FZCk1CYUFGQWVtYjZaNnBjR3IzK1ZCSTgvcG9DcER0cnFvTUhJR0NDc0dBUVVGQndFQkJHWXdaREEyQmdnckJnRUYKQlFjd0FvWXFhSFIwY0RvdkwzQnJhUzV0ZFd4MGFXTmxjblF1WTI5dEwyTmxjblF2ZEhOZlkyRXdNRFV1WTJWeQpNQ29HQ0NzR0FRVUZCekFCaGg1b2RIUndPaTh2YjJOemNDNXRkV3gwYVdObGNuUXVZMjl0TDI5amMzQXdRUVlEClZSMHVCRG93T0RBMm9EU2dNb1l3YUhSMGNEb3ZMM0JyYVM1dGRXeDBhV05sY25RdVkyOXRMMk55YkM5amNteGYKZEhNd01EVmZaR1ZzZEdFdVkzSnNNR0VHQTFVZElBUmFNRmd3Q1FZSEJBQ0w3RUFCQVRBUkJnOHJCZ0VFQVlIRApiZ0VCQVFFQUFSSXdPQVlOS3dZQkJBR0J3MjRCQVFFQUJ6QW5NQ1VHQ0NzR0FRVUZCd0lCRmhsb2RIUndjem92CkwzQnJhUzV0ZFd4MGFXTmxjblF1WTI5dE1JSUJWQVlJS3dZQkJRVUhBUU1FZ2dGR01JSUJRakFLQmdnckJnRUYKQlFjTEFqQUlCZ1lFQUk1R0FRRXdDd1lHQkFDT1JnRURBZ0VITUJNR0JnUUFqa1lCQmpBSkJnY0VBSTVHQVFZQwpNSUdoQmdZRUFJNUdBUVV3Z1pZd1NSWkRhSFIwY0hNNkx5OXdhMmt1YlhWc2RHbGpaWEowTG1OdmJTOXdiMnd2ClkzQnpMMDFWVEZSSlEwVlNWRjlRU2k1RFFUTmZNalF1TVY4d01EQXhYMlZ1TG5Ca1poTUNaVzR3U1JaRGFIUjAKY0hNNkx5OXdhMmt1YlhWc2RHbGpaWEowTG1OdmJTOXdiMnd2WTNCekwwMVZURlJKUTBWU1ZGOVFTaTVEUVROZgpNalF1TVY4d01EQXhYM0IwTG5Ca1poTUNjSFF3WkFZR0JBQ0JtQ2NDTUZvd0pqQVJCZ2NFQUlHWUp3RUNEQVpRClUxQmZVRWt3RVFZSEJBQ0JtQ2NCQXd3R1VGTlFYMEZKRENkVGQyVmthWE5vSUVacGJtRnVZMmxoYkNCVGRYQmwKY25acGMybHZiaUJCZFhSb2IzSnBkSGtNQjFORkxVWkpUa0V3T3dZRFZSMGZCRFF3TWpBd29DNmdMSVlxYUhSMApjRG92TDNCcmFTNXRkV3gwYVdObGNuUXVZMjl0TDJOeWJDOWpjbXhmZEhNd01EVXVZM0pzTUIwR0ExVWREZ1FXCkJCUS8vVFk5b3lkV2w0RGM4bkdZcjdQcStDb3NIVEFPQmdOVkhROEJBZjhFQkFNQ0JrQXdEUVlKS29aSWh2Y04KQVFFTEJRQURnZ0lCQUM2WmorMUJhS3ZqaUs2RmlXNis5SnVjKzhlcll3dVRQajBESVBJMTd1L0tTRnRXRXVEKwpUVS9SZGxDMk41ZlZCS2xsK3YreDVJN2hTSGFRMXZqR1Yrc1FWaUZwUlJJcWsrMEx5bmFDMmJ5MjY5eXBXNTFoCkVNdWZZb2lDaWp1VXNrem5lY2FxTlpaQWN2NmpHSUl2UWdNa0tVMjR1OGorVDczWU8vQnU0UVpZSmtaZjU2RlYKVjJLWEpRVXo1MmpkQ3ZOTGpVK1ltTVNrWDhtVVBUUjAra0t4TUxyMURTVFJENW1aVnBRZmsyK05DTGpXZnY0NwpsdTh1SW5BQXlCZTk3RHJFL00zMGZkeHUrOVBNRENFMDNnelRhcUxSM1VMSUxnekFGbVl6NWdxN2pUUDJ3NkppCnFLblR4NlJCWnFWWWJuME9CVGdUMmttNGVKVkprcytEdGRRVlVrQkR1NktPQVZRMjZOTmRncExSeXQ0RC8yL08KdmpWdkZWd2tZWDRJbStTQnZZaWsrMlp4bUJ2SlJSZ25GSi8xdlBnVXFKMzlZdnZiK0RIbEMrQVdyQ0hsRWVqZgp6eW5qYklNbVJOd1ZOYVdFUHlVamVvWmMyUFRqeW9qSW1JTEx0Q041TXA2WmEvbEh4RFluakV3MGxVYXVpci9DCkR3YlZzdno4RTRKdUE0QWNJakorMzZja3YvdG13ZlRWbnFyY2NOclRrelVNUm1iT2RVb3NnT1RGbWErb2JicXkKMjh2TDZJVmdoa1pWVi9zS21ISm1iWXowbmh4NFhhMXE3bHNrRXJaWmdYbFJJaXBlWFcvVFRlZGo0VmsrcERlVgpFWTVPNTRpWWNocUVyRmRnd3VtM3VKV0dJWExSSm9EWHMzcWNrZ3krL0lPMm02K0VDcENiRTMrYQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCgotLS0tLUJFR0lOIENFUlRJRklDQVRFLS0tLS0KTUlJSFN6Q0NCVE9nQXdJQkFnSVFFSm5oMjVvdlJhdDZkdzVRbVZheG5qQU5CZ2txaGtpRzl3MEJBUXNGQURDQgpoVEVMTUFrR0ExVUVCaE1DVUZReFFqQkFCZ05WQkFvTU9VMVZURlJKUTBWU1ZDQXRJRk5sY25acHc2ZHZjeUJrClpTQkRaWEowYVdacFkySERwOE9qYnlCRmJHVmpkSExEczI1cFkyRWdVeTVCTGpFeU1EQUdBMVVFQXd3cFRWVk0KVkVsRFJWSlVJRkp2YjNRZ1EyVnlkR2xtYVdOaGRHbHZiaUJCZFhSb2IzSnBkSGtnTURFd0hoY05NVGt4TWpBNQpNVGd6TkRNM1doY05Nekl3TmpBNE1UZ3pORE0zV2pDQnNqRUxNQWtHQTFVRUJoTUNVRlF4UWpCQUJnTlZCQW9NCk9VMVZURlJKUTBWU1ZDQXRJRk5sY25acHc2ZHZjeUJrWlNCRFpYSjBhV1pwWTJIRHA4T2pieUJGYkdWamRITEQKczI1cFkyRWdVeTVCTGpFZ01CNEdBMVVFQ3d3WFEyVnlkR2xtYVdOaGRHbHZiaUJCZFhSb2IzSnBkSGt4UFRBNwpCZ05WQkFNTU5FMVZURlJKUTBWU1ZDQlVjblZ6ZENCVFpYSjJhV05sY3lCRFpYSjBhV1pwWTJGMGFXOXVJRUYxCmRHaHZjbWwwZVNBd01EVXdnZ0lpTUEwR0NTcUdTSWIzRFFFQkFRVUFBNElDRHdBd2dnSUtBb0lDQVFEaGJDQzcKdkNIVFBtRjN0M1ozNlFNWks0d2JmcWtGVjMycVk2d3FVU09hT3E3MmYySjBLamJwek4yUTlVb0QvRGFQZ3d0WgpRNWtWSysrcXU3QTIrREowUVZZTmM0YkwzRk5ZQWRvQUREUXlNMzg1ZUlsT1ZSTDhnZWNROHZwdzA1YnMySXhjCklOOG93STY4QUkwcitWK29ybTdZS1EyanZnVS9HWGdOMDlEL1diQlNVek0wVkoxZlE0UEhva28rMUpDUDJ5QVoKam9ScjZJc2lkOW1WWWIwYkd4dVQ4YU9CMjNiK1VVYkduRGNweTJYK2tvOUZjMVpmTEZnZjQzQitBZnJKUklwOQpLSU9qV0lPRmxVbVBOcVdvODJjdkh5OGY5cjNRYnZja0xtZlVxSG8vWlFEaE5jNkcrSVJBYmx6U1pCbitoSWJYCktaVDdDaU9Hcjd5QkZUSCtKVzRpcnMvRms5SUU5QzBiM0c3Nlg1MkpodEUrSU1ZRWpFUWdUVGFMbHBZNnRwdHQKcmFWaDczMGFEdHZGOTRCYVk5T3poaDVMakUyTmp4cVlQQmxGZ2I3ZnV3Rk5URDBIM0E2T1E5ZXZXSzN0ejdZeApPYjB4d2hlNFVhN1hKOVlWdi9rc3pPODBvelkycHVhMmNVK09JbzRCTnJxQ2hhOGsyU1JNczdTOW1NTFZUVU5yCnNSQVpyRWdXSEVNWUVScUxaT3V1Q3ZBRzJmNXhaVGdWUzA5a09XOUxRNC9TODRDZXMrcDV5TGFDeTlaM1Yxai8KaUJpTFErUTFEQUhXZHByQjZ4TlM1ejdHM0NKVmFucFNtN3orUFMvWE1pNnNLUUVOOENkTjJleklSWS9SczdaNwp4cnJQM2xxcm40S0UveVo1Z1ZBM1JMcTZpT3ZtTVJmamIrcnpPUUlEQVFBQm80SUJoakNDQVlJd2RRWUlLd1lCCkJRVUhBUUVFYVRCbk1Ea0dDQ3NHQVFVRkJ6QUNoaTFvZEhSd09pOHZjR3RwY205dmRDNXRkV3gwYVdObGNuUXUKWTI5dEwyTmxjblF2Y205dmREQXdNUzVqWlhJd0tnWUlLd1lCQlFVSE1BR0dIbWgwZEhBNkx5OXZZM053TG0xMQpiSFJwWTJWeWRDNWpiMjB2YjJOemNEQWRCZ05WSFE0RUZnUVVCNlp2cG5xbHdhdmY1VUVqeittZ0trTzJ1cWd3CkVnWURWUjBUQVFIL0JBZ3dCZ0VCL3dJQkFEQWZCZ05WSFNNRUdEQVdnQlRWT1J5Y1cyOEVxcUtWVE84ZzNTbDAKcE1WRmNUQkRCZ05WSFNBRVBEQTZNRGdHRFNzR0FRUUJnY051QVFFQkFBY3dKekFsQmdnckJnRUZCUWNDQVJZWgphSFIwY0hNNkx5OXdhMmt1YlhWc2RHbGpaWEowTG1OdmJUQkJCZ05WSFI4RU9qQTRNRGFnTktBeWhqQm9kSFJ3Ck9pOHZjR3RwY205dmRDNXRkV3gwYVdObGNuUXVZMjl0TDJOeWJDOXliMjkwWDIxalgyTnliQzVqY213d0RnWUQKVlIwUEFRSC9CQVFEQWdFR01CMEdBMVVkSlFRV01CUUdDQ3NHQVFVRkJ3TUNCZ2dyQmdFRkJRY0RCREFOQmdrcQpoa2lHOXcwQkFRc0ZBQU9DQWdFQW1LR2lmSzBsVWNxN2NJcTdsdVczdUpTREgyelY1MlJ4TCtiSTlWSXRNdmQzCmlncENtMFd0V0lKZjZ0Mno2emtuOGpXVWpZL212VVJYSERKbFcrV2V1VkhsbTIvd2JIU0w5UXhKcjR0VjhQTFcKby9XRWVob214WFMrZHdERFVodElhOWNHSDZTWnRvekoyL0lMdU1QdllDVlRYSS9qL3VKL3JRT2l5VzJsTEFmTwpVQnI3em9ncmNFYTV4TmwwbzYrMnFLZFFsNU5rZ2RuKzZtL0dBQ1NJbHl4TWF2LzVyRkNub0xVVnJyZzJzdldLCjdlRkI5UldpYmVLWlJWelRiTUJpc2xiaElHN0F0aXYvOWYvcHdTOEdXQ2phdy9ldkpBeWNESVVjdVpWS0JITnEKVVZaaS9OdHdDaHhqTHM2MmIvczNzZU1saTlYZCttb2JMeXE4Y2ZoLzd5T09XaUJJVjc1c21HaWgvb3Jyb0IvSwpuaDFtNUJzQlBBaEJMMUMvblRuNGVMeHNZRE9Ya0VINFJOVWhIb2tVOGdRUThsbFNnd05WV04yWjkzeDlPcU40CllOQWZ3dERQOWpVN05uaHYwNTR4ajB2K0s5L0RYcmlpa28zbnFzVVdka0U5WnlyRzlScVJrMk1DUitnUFowcXIKUVkzRlZJb29jYnorQW1FT3EvS3pWTnh6Zlp6NDAveXhjZGdQdldqYWtLSzFXZUxaMVE5NSsvVGtmR2ZiSjZSNQpxaVM3WHcydnpoTlQwb0JNdDR1Q0gwZlI5S3hxWVR0VkZsT3hZNWpnUlBYU1loQnJtYmVYTHg1N0FNQXhRL1A0CmRGWTVoVUpDRGRlY0FaYWhKWndjRnAxVnhHblpHYzFQMFNZZm9XNm1DSDJoeDM4QTRJcER6VkYxVU9FTkhNZz0KLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQoKLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUY4VENDQTltZ0F3SUJBZ0lJVkUybHZFQTFWbG93RFFZSktvWklodmNOQVFFTEJRQXdnWVV4Q3pBSkJnTlYKQkFZVEFsQlVNVUl3UUFZRFZRUUtERGxOVlV4VVNVTkZVbFFnTFNCVFpYSjJhY09uYjNNZ1pHVWdRMlZ5ZEdsbQphV05odzZmRG8yOGdSV3hsWTNSeXc3TnVhV05oSUZNdVFTNHhNakF3QmdOVkJBTU1LVTFWVEZSSlEwVlNWQ0JTCmIyOTBJRU5sY25ScFptbGpZWFJwYjI0Z1FYVjBhRzl5YVhSNUlEQXhNQjRYRFRFME1EUXdOREE0TlRrME4xb1gKRFRNNU1EUXdOREE0TlRrME4xb3dnWVV4Q3pBSkJnTlZCQVlUQWxCVU1VSXdRQVlEVlFRS0REbE5WVXhVU1VORgpVbFFnTFNCVFpYSjJhY09uYjNNZ1pHVWdRMlZ5ZEdsbWFXTmh3NmZEbzI4Z1JXeGxZM1J5dzdOdWFXTmhJRk11ClFTNHhNakF3QmdOVkJBTU1LVTFWVEZSSlEwVlNWQ0JTYjI5MElFTmxjblJwWm1sallYUnBiMjRnUVhWMGFHOXkKYVhSNUlEQXhNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDQWdFQXp0dy85Qmx1dXhWcApodlRremVjNmNEdkhtb3M3Z3dDQlcvc2dGbHErdjFnQVh5bm1WMjkraWl3VkIxd2FZNHhDWHhiZDJvbUVSVmNYCmxxQ2NvWFVpUVJvNi9jVVhrUlAydm1JS3ZHNGxMVnZBakJCbTkrTFcrOXhJTWFNYXFPVk5TTW1pSEhQK2oyWkEKWTNkWkJ6dzlGSi9VOTRXUjBNTkM5UnRoczNlQWdDcHRFZ0tXaTFIWndXOG5DeG9ITkFELzBsbE1LZWpYR1dQWQprYlEvL0k0T0pmS2hFZ2RseWpYZXEvNFdvd2lNcjM5K0V2UlpGZ1VmNksxMGVUTDNlQUsydE15cjJ4NDRZUVFaCmVrRkEybG9SWkhVQy9XVFIxcFJDRHlMblpjMnZrQTRNV3pFQm1WSHZSWXg5cFRqYW5ueEw1S2JvczZTQzFnTTAKTGsrM1VhdDNPQW4xQnY3Y1poc1BQL3A5NzR4VnZ1QU5ocFdoM0wzRXd3alJSUjd5dmI1dzhlWW14cnNJc1NpbAp3cVh0aU5haHdQc2o4U2M1ek9HRUJ4bThmdmJNT1A5dUVMdEc2U09KSklIL0FPSlJBTnhTVUgwVFVIMFdQVUNOCjA3LzVpbVhZWWhJcGQ4SzZ3a2swVDRwNWFjbExGZk0wM3Mrdmh1TGx5S2xXWVV3R1ZGckZiQm5xODhoRXpTUWEKZHRGeEFGbHIyWFdienYwUS9yR0RvcVcza29aMm0wcjNIZHlNaGFaWXJZcW1hR2tYeVcwYnBzOG5TeWtzM1hGQwpHb2tRNWRXYkVsOUppNFM4MkFoYys4ODRRcSsrMFc1N2thcG1RTVVGZml2UVpyYkgzMUwrOUVWdEk1SWhuaElCCmtIT0Q0cVVKRGRmQStJV1ZIbVBSUHpYYWxORTMyZlVDQXdFQUFhTmpNR0V3SFFZRFZSME9CQllFRk5VNUhKeGIKYndTcW9wVk03eURkS1hTa3hVVnhNQThHQTFVZEV3RUIvd1FGTUFNQkFmOHdId1lEVlIwakJCZ3dGb0FVMVRrYwpuRnR2QktxaWxVenZJTjBwZEtURlJYRXdEZ1lEVlIwUEFRSC9CQVFEQWdFR01BMEdDU3FHU0liM0RRRUJDd1VBCkE0SUNBUUEvNTEvekloYmVnNTRnNUlMbjVaNTN5ZnNyc0hRTjN4dDBJZzl6RUtHd0YreE1ETlFvY0dwbWNrUnAKRUpOMk5jOHYrSTg4cXhsOGNaS1ZjUnMzRmNJYktIcnZibmc0My91UG13RWczSy8yMW8wSlp0ckVScW44bGFwRQpJeExmUjhDd0ZleTFzWjVzRDVHcXBqcmx3UTFnYkZCQWNGeGN5TTZ6ek92dHFvZ1pWcVdreUF4NjVYWkFaek8wClBaYmNkOHNqZVBsVFc4K04zckduamxwNm9qSmpvNGpYSldGYVhVazZjdWJQcXBTR2JHNzNndUNPWjVNb3hhZ04KVGU4NHJYbEtabzJFQVFnRWVmTlN4a0hubW1JR3MvVVNIdXpaQUVQVDY1WjNkT0Y1K1JTVWhHMjZWSUlGak44Qgo4akNJZ2F4Nkw0dERMSFkwempYbmg0NU9Dd3FsR2xleFUxcS9hOWkrQUg3RytlNW1NUWl4MzVRemhKeDNUM3RrCkwrK09EMWtvSXN2d1hENHIvVFhXbGY4RDdHVlNmcjd5R2ZoNzFWSXNVbmVha1daQmNJM1ZTZWNMU0grS3J0NUYKUGQzKzV0TGtrc043empDZ1NXNDNyYWpUTExZOW5pSGJCbGZpOEs0Rys5bkZFVGVoZTlzZEVYeG9kaUErOWJ5bAoyV2ExSWExRkpzWmRIZ0tqUWNUVWZZRVp5eGVYQmcvbTdIUUFSc1IxM1Qzd1F6U3Zwcno4OW9MN3o4WDZzdzhsCnBUOW1FTmFlZ3FYYk9oTjUzbzJwMTZhTmh0SXYyV2tONG5WNGZrbGZJcXVHY0NoUnMzcTJvSG42MU9XRHA3QjMKeXRzQmd1L2l2azB2MDhCTjBPTnBibndtbSt1bSswWHZzUVNLTDZvaEJ2Ym0xTHhCSXc9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==";

    CertificateValues certificateValues =
            new CertificateValues(
                    "7d4fbf3a6e44f720662dcfce2b6958ac",
                    "CN=MULTICERT Trust Services Certification Authority 005, OU=Certification Authority, O=MULTICERT - Serviços de Certificação Electrónica S.A., C=PT",
                    "MIIH1jCCBb6gAwIBAgIQfU+/Om5E9yBmLc/OK2lYrDANBgkqhkiG9w0BAQsFADCBsjELMAkGA1UEBhMCUFQxQjBABgNVBAoMOU1VTFRJQ0VSVCAtIFNlcnZpw6dvcyBkZSBDZXJ0aWZpY2HDp8OjbyBFbGVjdHLDs25pY2EgUy5BLjEgMB4GA1UECwwXQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkxPTA7BgNVBAMMNE1VTFRJQ0VSVCBUcnVzdCBTZXJ2aWNlcyBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eSAwMDUwHhcNMjEwNDEyMTQxMDE5WhcNMjMwNDEyMjM1OTU5WjCBhTELMAkGA1UEBhMCU0UxEDAOBgNVBAoMB1RpbmsgQUIxGTAXBgNVBGEMEFBTRFNFLUZJTkEtNDQwNTkxNzA1BgNVBAsMLlBTRDIgUXVhbGlmaWVkIENlcnRpZmljYXRlIGZvciBFbGVjdHJvbmljIFNlYWwxEDAOBgNVBAMMB1RpbmsgQUIwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDWFalvLmlPSTQovdtlc2jRCSIO1vMSSj5/Q8d2RZBaJHj+Le4xb0k/QO5BDtmONNh8Bbzmfzbqbkx/Ciz1DGaXBb+2cL6ap1Woyd0QZcROUadCStHZZYg8wp7yqgdplQM59m1I8yBkFC15b9tvulclf5j44jnqM1HbxTcXFsBpGiC5vb+IAllaytyyefC1/cT/M9FdX/VMwjWSXVZ2pbkZQIyCM93JVZXDudh+OFfneAksBQO+7sD6GoPJodMdEWNRGW5HYR15IZWj+KcUS8AWjVBl5Q1rovQ4x0QEWriJ9UrJ4cMT7FRQsPYVYk537Wk6TXOcwN6Dd81lKqlfLfBvAgMBAAGjggMRMIIDDTAMBgNVHRMBAf8EAjAAMB8GA1UdIwQYMBaAFAemb6Z6pcGr3+VBI8/poCpDtrqoMHIGCCsGAQUFBwEBBGYwZDA2BggrBgEFBQcwAoYqaHR0cDovL3BraS5tdWx0aWNlcnQuY29tL2NlcnQvdHNfY2EwMDUuY2VyMCoGCCsGAQUFBzABhh5odHRwOi8vb2NzcC5tdWx0aWNlcnQuY29tL29jc3AwQQYDVR0uBDowODA2oDSgMoYwaHR0cDovL3BraS5tdWx0aWNlcnQuY29tL2NybC9jcmxfdHMwMDVfZGVsdGEuY3JsMGEGA1UdIARaMFgwCQYHBACL7EABATARBg8rBgEEAYHDbgEBAQEAARIwOAYNKwYBBAGBw24BAQEABzAnMCUGCCsGAQUFBwIBFhlodHRwczovL3BraS5tdWx0aWNlcnQuY29tMIIBVAYIKwYBBQUHAQMEggFGMIIBQjAKBggrBgEFBQcLAjAIBgYEAI5GAQEwCwYGBACORgEDAgEHMBMGBgQAjkYBBjAJBgcEAI5GAQYCMIGhBgYEAI5GAQUwgZYwSRZDaHR0cHM6Ly9wa2kubXVsdGljZXJ0LmNvbS9wb2wvY3BzL01VTFRJQ0VSVF9QSi5DQTNfMjQuMV8wMDAxX2VuLnBkZhMCZW4wSRZDaHR0cHM6Ly9wa2kubXVsdGljZXJ0LmNvbS9wb2wvY3BzL01VTFRJQ0VSVF9QSi5DQTNfMjQuMV8wMDAxX3B0LnBkZhMCcHQwZAYGBACBmCcCMFowJjARBgcEAIGYJwECDAZQU1BfUEkwEQYHBACBmCcBAwwGUFNQX0FJDCdTd2VkaXNoIEZpbmFuY2lhbCBTdXBlcnZpc2lvbiBBdXRob3JpdHkMB1NFLUZJTkEwOwYDVR0fBDQwMjAwoC6gLIYqaHR0cDovL3BraS5tdWx0aWNlcnQuY29tL2NybC9jcmxfdHMwMDUuY3JsMB0GA1UdDgQWBBQ//TY9oydWl4Dc8nGYr7Pq+CosHTAOBgNVHQ8BAf8EBAMCBkAwDQYJKoZIhvcNAQELBQADggIBAC6Zj+1BaKvjiK6FiW6+9Juc+8erYwuTPj0DIPI17u/KSFtWEuD+TU/RdlC2N5fVBKll+v+x5I7hSHaQ1vjGV+sQViFpRRIqk+0LynaC2by269ypW51hEMufYoiCijuUskznecaqNZZAcv6jGIIvQgMkKU24u8j+T73YO/Bu4QZYJkZf56FVV2KXJQUz52jdCvNLjU+YmMSkX8mUPTR0+kKxMLr1DSTRD5mZVpQfk2+NCLjWfv47lu8uInAAyBe97DrE/M30fdxu+9PMDCE03gzTaqLR3ULILgzAFmYz5gq7jTP2w6JiqKnTx6RBZqVYbn0OBTgT2km4eJVJks+DtdQVUkBDu6KOAVQ26NNdgpLRyt4D/2/OvjVvFVwkYX4Im+SBvYik+2ZxmBvJRRgnFJ/1vPgUqJ39Yvvb+DHlC+AWrCHlEejfzynjbIMmRNwVNaWEPyUjeoZc2PTjyojImILLtCN5Mp6Za/lHxDYnjEw0lUauir/CDwbVsvz8E4JuA4AcIjJ+36ckv/tmwfTVnqrccNrTkzUMRmbOdUosgOTFma+obbqy28vL6IVghkZVV/sKmHJmbYz0nhx4Xa1q7lskErZZgXlRIipeXW/TTedj4Vk+pDeVEY5O54iYchqErFdgwum3uJWGIXLRJoDXs3qckgy+/IO2m6+ECpCbE3+a");

    @Test
    public void shouldExtractCertificateValuesFromGivenBase64EncodedCertificate() {
        // when
        CertificateValues actualCertificateValues =
                CertificateValuesProvider.extractCertificateValues(base64EncodedCertificate);
        // then
        assertThat(actualCertificateValues).isEqualToComparingFieldByField(certificateValues);
    }

    @Test
    public void shouldThrowExceptionIfArgumentIsNull() {
        // when
        IllegalArgumentException exception =
                assertThrows(
                        IllegalArgumentException.class,
                        () -> CertificateValuesProvider.extractCertificateValues(null));
        // then
        assertThat(exception.getMessage())
                .isEqualTo("Must provide valid base64-encoded certificates");
    }

    @Test
    public void shouldThrowExceptionIfArgumentIsEmpty() {
        // when
        IllegalArgumentException exception =
                assertThrows(
                        IllegalArgumentException.class,
                        () -> CertificateValuesProvider.extractCertificateValues(""));
        // then
        assertThat(exception.getMessage())
                .isEqualTo("Must provide valid base64-encoded certificates");
    }

    @Test
    public void shouldThrowExceptionIfArgumentIsInvalid() {
        // when
        IllegalArgumentException exception =
                assertThrows(
                        IllegalArgumentException.class,
                        () -> CertificateValuesProvider.extractCertificateValues("fghjkl"));
        // then
        assertThat(exception.getMessage())
                .isEqualTo("Must provide valid base64-encoded certificates");
    }

    //
    //  @Test
    //  public void shouldThrowExceptionIfArgumentIsInvalid() {
    //    // given
    //    String expectedExceptionMessage = "Must provide base64-encoded certificates";
    //    String invalidBase64EncodedCertificates = "invalidBase64EncodedCertificates";
    //
    //    // when
    //    try {
    //      CertificateValuesProvider.extractCertificateValues(invalidBase64EncodedCertificates);
    //
    //    } catch (Exception exception) {
    //      String actualExceptionMessage = exception.getMessage();
    //
    //    // then
    //      assertThat(actualExceptionMessage).isEqualTo(expectedExceptionMessage);
    //    }
    //  }
    //
    //  @Test
    //  public void shouldThrowExceptionIfCannotExtractCertificateValues() {
    //    // given
    //    String expectedExceptionMessage = "";
    //    String base64EncodedCertificates = "";
    ////
    // Mockito.when(CertificateUtils.getX509CertificatesFromBase64EncodedCert(base64EncodedCertificates)).thenReturn();
    //
    //    // when
    //        CertificateValues actualCertificateValues =
    //        CertificateValuesProvider.extractCertificateValues(base64EncodedCertificates);
    //    String actualExceptionMessage = "";
    //
    //    // then
    //    assertThat(actualExceptionMessage).isEqualTo(expectedExceptionMessage);
    //  }
}
