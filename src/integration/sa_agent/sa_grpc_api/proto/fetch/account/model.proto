syntax = "proto3";

option java_multiple_files = true;
option java_package = "se.tink.sa.services.fetch.account";
option java_outer_classname = "OuterModel";
option go_package = "proto";

import "google/type/date.proto";
import "src/integration/sa_agent/sa_grpc_api/proto/fetch/account/accounttype.proto";

message FetchAccountsRequest {
  string consentId = 1;
}

message FetchAccountsResponse {
  repeated TransactionalAccount account = 1;
}

message TransactionalAccount {
  string accountNumber = 1;
  AccountExclusion accountExclusion = 2;
  double availableCredit = 3;
  ExactCurrencyAmount exactAvailableCredit = 4;
  double balance = 5;
  ExactCurrencyAmount exactBalance = 6;
  string currencyCode = 7;
  string bankId = 8;
  google.type.Date certainDate = 9;
  string credentialsId = 10;
  bool excluded = 11;
  bool favored = 12;
  string id = 13;
  string name = 14;
  double ownership = 15;
  string payload = 16;
  TransactionalAccountType type = 17;
  string userId = 18;
  bool userModifiedExcluded = 19;
  bool userModifiedName = 20;
  bool userModifiedType = 21;
  repeated AccountIdentifier identifiers = 22;
  repeated TransferDestination transferDestinations = 23;
  AccountDetails details = 24;
  bool closed = 25;
  string holderName = 26;
  repeated AccountFlag flags = 27;
  string financialInstitutionId = 28;
}

enum AccountExclusion {
    AGGREGATION = 0;
    PFM_AND_SEARCH = 1;
    PFM_DATA = 2;
    NONE = 3;
}

message ExactCurrencyAmount {
  string value = 1;
  string currencyCode = 2;
}

message TransferDestination {
  double balance = 1;
  URI uri = 2;
  string name = 3;
  string type = 4;
}

message URI {
  string path = 1;
}

message AccountDetails {
  double interest = 1;
  int32 numMonthsBound = 2;
  string type = 3;
  google.type.Date nextDayOfTermsChange = 4;
}

enum AccountFlag {
  BUSINESS = 0;
  MANDATE = 1;
  PSD2_PAYMENT_ACCOUNT = 2;
}

message TransactionalAccountV2 {
  TransactionalAccountType accountType = 1;
  IdModule idModule = 2;
  string name = 3;
  string productName = 4;
  string accountNumber = 5;
  repeated AccountIdentifier identifiers = 6;
  string uniqueIdentifier = 7;
  string apiIdentifier = 8;
  HolderName holderName = 9;
  map<string, string> temporaryStorage = 10;
  repeated AccountFlag accountFlags = 11;
  ExactCurrencyAmount exactBalance = 12;
  ExactCurrencyAmount exactAvailableCredit = 13;
}

message IdModule {
  string uniqueId = 1;
  string accountNumber = 2;
  string accountName = 3;
  string productName = 4;
  repeated AccountIdentifier identifiers = 5;
}

message AccountIdentifier {
  string name = 1;
  string id = 2;
  AccountIdentifierType type = 3;
}

enum AccountIdentifierType {
  BE = 0;
  DK = 1;
  SE = 2;
  SE_SHB_INTERNAL = 3;
  SE_NDA_SSN = 4;
  FI = 5;
  NO = 6;
  IBAN = 7;
  TINK = 8;
  SE_BG = 9;
  SE_PG = 10;
  SEPA_EUR = 11;
  SORT_CODE = 12;
  PAYMENT_CARD_NUMBER = 13;
  PAYM_PHONE_NUMBER = 14;
  BBAN = 15;
  COUNTRY_SPECIFIC = 16;
}

message HolderName {
  string value = 1;
}
